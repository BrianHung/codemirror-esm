{"version":3,"file":"multiplex.js","sources":["../../../../src/addon/mode/multiplex.js"],"sourcesContent":["// Source: https://github.com/codemirror/CodeMirror/tree/master/addon/mode/multiplex.js\nexport default function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.multiplexingMode = function(outer ) {\n    var others = Array.prototype.slice.call(arguments, 1);\n\n    function indexOf(string, pattern, from, returnEnd) {\n      if (typeof pattern == \"string\") {\n        var found = string.indexOf(pattern, from);\n        return returnEnd && found > -1 ? found + pattern.length : found;\n      }\n      var m = pattern.exec(from ? string.slice(from) : string);\n      return m ? m.index + from + (returnEnd ? m[0].length : 0) : -1;\n    }\n\n    return {\n      startState: function() {\n        return {\n          outer: CodeMirror.startState(outer),\n          innerActive: null,\n          inner: null\n        };\n      },\n\n      copyState: function(state) {\n        return {\n          outer: CodeMirror.copyState(outer, state.outer),\n          innerActive: state.innerActive,\n          inner: state.innerActive && CodeMirror.copyState(state.innerActive.mode, state.inner)\n        };\n      },\n\n      token: function(stream, state) {\n        if (!state.innerActive) {\n          var cutOff = Infinity, oldContent = stream.string;\n          for (var i = 0; i < others.length; ++i) {\n            var other = others[i];\n            var found = indexOf(oldContent, other.open, stream.pos);\n            if (found == stream.pos) {\n              if (!other.parseDelimiters) stream.match(other.open);\n              state.innerActive = other;\n\n              var outerIndent = 0;\n              if (outer.indent) {\n                var possibleOuterIndent = outer.indent(state.outer, \"\", \"\");\n                if (possibleOuterIndent !== CodeMirror.Pass) outerIndent = possibleOuterIndent;\n              }\n\n              state.inner = CodeMirror.startState(other.mode, outerIndent);\n              return other.delimStyle && (other.delimStyle + \" \" + other.delimStyle + \"-open\");\n            } else if (found != -1 && found < cutOff) {\n              cutOff = found;\n            }\n          }\n          if (cutOff != Infinity) stream.string = oldContent.slice(0, cutOff);\n          var outerToken = outer.token(stream, state.outer);\n          if (cutOff != Infinity) stream.string = oldContent;\n          return outerToken;\n        } else {\n          var curInner = state.innerActive, oldContent = stream.string;\n          if (!curInner.close && stream.sol()) {\n            state.innerActive = state.inner = null;\n            return this.token(stream, state);\n          }\n          var found = curInner.close ? indexOf(oldContent, curInner.close, stream.pos, curInner.parseDelimiters) : -1;\n          if (found == stream.pos && !curInner.parseDelimiters) {\n            stream.match(curInner.close);\n            state.innerActive = state.inner = null;\n            return curInner.delimStyle && (curInner.delimStyle + \" \" + curInner.delimStyle + \"-close\");\n          }\n          if (found > -1) stream.string = oldContent.slice(0, found);\n          var innerToken = curInner.mode.token(stream, state.inner);\n          if (found > -1) stream.string = oldContent;\n\n          if (found == stream.pos && curInner.parseDelimiters)\n            state.innerActive = state.inner = null;\n\n          if (curInner.innerStyle) {\n            if (innerToken) innerToken = innerToken + \" \" + curInner.innerStyle;\n            else innerToken = curInner.innerStyle;\n          }\n\n          return innerToken;\n        }\n      },\n\n      indent: function(state, textAfter, line) {\n        var mode = state.innerActive ? state.innerActive.mode : outer;\n        if (!mode.indent) return CodeMirror.Pass;\n        return mode.indent(state.innerActive ? state.inner : state.outer, textAfter, line);\n      },\n\n      blankLine: function(state) {\n        var mode = state.innerActive ? state.innerActive.mode : outer;\n        if (mode.blankLine) {\n          mode.blankLine(state.innerActive ? state.inner : state.outer);\n        }\n        if (!state.innerActive) {\n          for (var i = 0; i < others.length; ++i) {\n            var other = others[i];\n            if (other.open === \"\\n\") {\n              state.innerActive = other;\n              state.inner = CodeMirror.startState(other.mode, mode.indent ? mode.indent(state.outer, \"\", \"\") : 0);\n            }\n          }\n        } else if (state.innerActive.close === \"\\n\") {\n          state.innerActive = state.inner = null;\n        }\n      },\n\n      electricChars: outer.electricChars,\n\n      innerMode: function(state) {\n        return state.inner ? {state: state.inner, mode: state.innerActive.mode} : {state: state.outer, mode: outer};\n      }\n    };\n  };\n\n}"],"names":[],"mappings":"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"}