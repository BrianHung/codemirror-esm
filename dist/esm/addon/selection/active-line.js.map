{"version":3,"file":"active-line.js","sources":["../../../../src/addon/selection/active-line.js"],"sourcesContent":["// Source: https://github.com/codemirror/CodeMirror/tree/master/addon/selection/active-line.js\nexport default function(CodeMirror) {\n  \"use strict\";\n  var WRAP_CLASS = \"CodeMirror-activeline\";\n  var BACK_CLASS = \"CodeMirror-activeline-background\";\n  var GUTT_CLASS = \"CodeMirror-activeline-gutter\";\n\n  CodeMirror.defineOption(\"styleActiveLine\", false, function(cm, val, old) {\n    var prev = old == CodeMirror.Init ? false : old;\n    if (val == prev) return\n    if (prev) {\n      cm.off(\"beforeSelectionChange\", selectionChange);\n      clearActiveLines(cm);\n      delete cm.state.activeLines;\n    }\n    if (val) {\n      cm.state.activeLines = [];\n      updateActiveLines(cm, cm.listSelections());\n      cm.on(\"beforeSelectionChange\", selectionChange);\n    }\n  });\n\n  function clearActiveLines(cm) {\n    for (var i = 0; i < cm.state.activeLines.length; i++) {\n      cm.removeLineClass(cm.state.activeLines[i], \"wrap\", WRAP_CLASS);\n      cm.removeLineClass(cm.state.activeLines[i], \"background\", BACK_CLASS);\n      cm.removeLineClass(cm.state.activeLines[i], \"gutter\", GUTT_CLASS);\n    }\n  }\n\n  function sameArray(a, b) {\n    if (a.length != b.length) return false;\n    for (var i = 0; i < a.length; i++)\n      if (a[i] != b[i]) return false;\n    return true;\n  }\n\n  function updateActiveLines(cm, ranges) {\n    var active = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i];\n      var option = cm.getOption(\"styleActiveLine\");\n      if (typeof option == \"object\" && option.nonEmpty ? range.anchor.line != range.head.line : !range.empty())\n        continue\n      var line = cm.getLineHandleVisualStart(range.head.line);\n      if (active[active.length - 1] != line) active.push(line);\n    }\n    if (sameArray(cm.state.activeLines, active)) return;\n    cm.operation(function() {\n      clearActiveLines(cm);\n      for (var i = 0; i < active.length; i++) {\n        cm.addLineClass(active[i], \"wrap\", WRAP_CLASS);\n        cm.addLineClass(active[i], \"background\", BACK_CLASS);\n        cm.addLineClass(active[i], \"gutter\", GUTT_CLASS);\n      }\n      cm.state.activeLines = active;\n    });\n  }\n\n  function selectionChange(cm, sel) {\n    updateActiveLines(cm, sel.ranges);\n  }\n}"],"names":[],"mappings":"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"}