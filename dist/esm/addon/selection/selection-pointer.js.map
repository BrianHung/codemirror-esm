{"version":3,"file":"selection-pointer.js","sources":["../../../../src/addon/selection/selection-pointer.js"],"sourcesContent":["// Source: https://github.com/codemirror/CodeMirror/tree/master/addon/selection/selection-pointer.js\nexport default function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.defineOption(\"selectionPointer\", false, function(cm, val) {\n    var data = cm.state.selectionPointer;\n    if (data) {\n      CodeMirror.off(cm.getWrapperElement(), \"mousemove\", data.mousemove);\n      CodeMirror.off(cm.getWrapperElement(), \"mouseout\", data.mouseout);\n      CodeMirror.off(window, \"scroll\", data.windowScroll);\n      cm.off(\"cursorActivity\", reset);\n      cm.off(\"scroll\", reset);\n      cm.state.selectionPointer = null;\n      cm.display.lineDiv.style.cursor = \"\";\n    }\n    if (val) {\n      data = cm.state.selectionPointer = {\n        value: typeof val == \"string\" ? val : \"default\",\n        mousemove: function(event) { mousemove(cm, event); },\n        mouseout: function(event) { mouseout(cm, event); },\n        windowScroll: function() { reset(cm); },\n        rects: null,\n        mouseX: null, mouseY: null,\n        willUpdate: false\n      };\n      CodeMirror.on(cm.getWrapperElement(), \"mousemove\", data.mousemove);\n      CodeMirror.on(cm.getWrapperElement(), \"mouseout\", data.mouseout);\n      CodeMirror.on(window, \"scroll\", data.windowScroll);\n      cm.on(\"cursorActivity\", reset);\n      cm.on(\"scroll\", reset);\n    }\n  });\n\n  function mousemove(cm, event) {\n    var data = cm.state.selectionPointer;\n    if (event.buttons == null ? event.which : event.buttons) {\n      data.mouseX = data.mouseY = null;\n    } else {\n      data.mouseX = event.clientX;\n      data.mouseY = event.clientY;\n    }\n    scheduleUpdate(cm);\n  }\n\n  function mouseout(cm, event) {\n    if (!cm.getWrapperElement().contains(event.relatedTarget)) {\n      var data = cm.state.selectionPointer;\n      data.mouseX = data.mouseY = null;\n      scheduleUpdate(cm);\n    }\n  }\n\n  function reset(cm) {\n    cm.state.selectionPointer.rects = null;\n    scheduleUpdate(cm);\n  }\n\n  function scheduleUpdate(cm) {\n    if (!cm.state.selectionPointer.willUpdate) {\n      cm.state.selectionPointer.willUpdate = true;\n      setTimeout(function() {\n        update(cm);\n        cm.state.selectionPointer.willUpdate = false;\n      }, 50);\n    }\n  }\n\n  function update(cm) {\n    var data = cm.state.selectionPointer;\n    if (!data) return;\n    if (data.rects == null && data.mouseX != null) {\n      data.rects = [];\n      if (cm.somethingSelected()) {\n        for (var sel = cm.display.selectionDiv.firstChild; sel; sel = sel.nextSibling)\n          data.rects.push(sel.getBoundingClientRect());\n      }\n    }\n    var inside = false;\n    if (data.mouseX != null) for (var i = 0; i < data.rects.length; i++) {\n      var rect = data.rects[i];\n      if (rect.left <= data.mouseX && rect.right >= data.mouseX &&\n          rect.top <= data.mouseY && rect.bottom >= data.mouseY)\n        inside = true;\n    }\n    var cursor = inside ? data.value : \"\";\n    if (cm.display.lineDiv.style.cursor != cursor)\n      cm.display.lineDiv.style.cursor = cursor;\n  }\n}"],"names":[],"mappings":"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"}