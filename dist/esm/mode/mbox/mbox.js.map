{"version":3,"file":"mbox.js","sources":["../../../../src/mode/mbox/mbox.js"],"sourcesContent":["// Source: https://github.com/codemirror/CodeMirror/tree/master/mode/mbox/mbox.js\nexport default function(CodeMirror) {\n  \"use strict\";\n\n  var rfc2822 = [\n    \"From\", \"Sender\", \"Reply-To\", \"To\", \"Cc\", \"Bcc\", \"Message-ID\",\n    \"In-Reply-To\", \"References\", \"Resent-From\", \"Resent-Sender\", \"Resent-To\",\n    \"Resent-Cc\", \"Resent-Bcc\", \"Resent-Message-ID\", \"Return-Path\", \"Received\"\n  ];\n  var rfc2822NoEmail = [\n    \"Date\", \"Subject\", \"Comments\", \"Keywords\", \"Resent-Date\"\n  ];\n\n  CodeMirror.registerHelper(\"hintWords\", \"mbox\", rfc2822.concat(rfc2822NoEmail));\n\n  var whitespace = /^[ \\t]/;\n  var separator = /^From /; \n  var rfc2822Header = new RegExp(\"^(\" + rfc2822.join(\"|\") + \"): \");\n  var rfc2822HeaderNoEmail = new RegExp(\"^(\" + rfc2822NoEmail.join(\"|\") + \"): \");\n  var header = /^[^:]+:/; \n  var email = /^[^ ]+@[^ ]+/;\n  var untilEmail = /^.*?(?=[^ ]+?@[^ ]+)/;\n  var bracketedEmail = /^<.*?>/;\n  var untilBracketedEmail = /^.*?(?=<.*>)/;\n\n  function styleForHeader(header) {\n    if (header === \"Subject\") return \"header\";\n    return \"string\";\n  }\n\n  function readToken(stream, state) {\n    if (stream.sol()) {\n      state.inSeparator = false;\n      if (state.inHeader && stream.match(whitespace)) {\n        return null;\n      } else {\n        state.inHeader = false;\n        state.header = null;\n      }\n\n      if (stream.match(separator)) {\n        state.inHeaders = true;\n        state.inSeparator = true;\n        return \"atom\";\n      }\n\n      var match;\n      var emailPermitted = false;\n      if ((match = stream.match(rfc2822HeaderNoEmail)) ||\n        (emailPermitted = true) && (match = stream.match(rfc2822Header))) {\n        state.inHeaders = true;\n        state.inHeader = true;\n        state.emailPermitted = emailPermitted;\n        state.header = match[1];\n        return \"atom\";\n      }\n\n      if (state.inHeaders && (match = stream.match(header))) {\n        state.inHeader = true;\n        state.emailPermitted = true;\n        state.header = match[1];\n        return \"atom\";\n      }\n\n      state.inHeaders = false;\n      stream.skipToEnd();\n      return null;\n    }\n\n    if (state.inSeparator) {\n      if (stream.match(email)) return \"link\";\n      if (stream.match(untilEmail)) return \"atom\";\n      stream.skipToEnd();\n      return \"atom\";\n    }\n\n    if (state.inHeader) {\n      var style = styleForHeader(state.header);\n\n      if (state.emailPermitted) {\n        if (stream.match(bracketedEmail)) return style + \" link\";\n        if (stream.match(untilBracketedEmail)) return style;\n      }\n      stream.skipToEnd();\n      return style;\n    }\n\n    stream.skipToEnd();\n    return null;\n  };\n\n  CodeMirror.defineMode(\"mbox\", function() {\n    return {\n      startState: function() {\n        return {\n          inSeparator: false,\n          inHeader: false,\n          emailPermitted: false,\n          header: null,\n          inHeaders: false\n        };\n      },\n      token: readToken,\n      blankLine: function(state) {\n        state.inHeaders = state.inSeparator = state.inHeader = false;\n      }\n    };\n  });\n\n  CodeMirror.defineMIME(\"application/mbox\", \"mbox\");\n}"],"names":[],"mappings":"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"}