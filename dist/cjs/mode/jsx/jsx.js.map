{"version":3,"file":"jsx.js","sources":["../../../../src/mode/jsx/jsx.js"],"sourcesContent":["// Source: https://github.com/codemirror/CodeMirror/tree/master/mode/jsx/jsx.js\nimport xml from \"../xml/xml\"\nimport javascript from \"../javascript/javascript\"\nexport default function(CodeMirror) {\n  xml(CodeMirror)\n  javascript(CodeMirror)\n  \"use strict\"\n\n  function Context(state, mode, depth, prev) {\n    this.state = state; this.mode = mode; this.depth = depth; this.prev = prev\n  }\n\n  function copyContext(context) {\n    return new Context(CodeMirror.copyState(context.mode, context.state),\n      context.mode,\n      context.depth,\n      context.prev && copyContext(context.prev))\n  }\n\n  CodeMirror.defineMode(\"jsx\", function(config, modeConfig) {\n    var xmlMode = CodeMirror.getMode(config, {name: \"xml\", allowMissing: true, multilineTagIndentPastTag: false, allowMissingTagName: true})\n    var jsMode = CodeMirror.getMode(config, modeConfig && modeConfig.base || \"javascript\")\n\n    function flatXMLIndent(state) {\n      var tagName = state.tagName\n      state.tagName = null\n      var result = xmlMode.indent(state, \"\", \"\")\n      state.tagName = tagName\n      return result\n    }\n\n    function token(stream, state) {\n      if (state.context.mode == xmlMode)\n        return xmlToken(stream, state, state.context)\n      else\n        return jsToken(stream, state, state.context)\n    }\n\n    function xmlToken(stream, state, cx) {\n      if (cx.depth == 2) { \n        if (stream.match(/^.*?\\*\\//)) cx.depth = 1\n        else stream.skipToEnd()\n        return \"comment\"\n      }\n\n      if (stream.peek() == \"{\") {\n        xmlMode.skipAttribute(cx.state)\n\n        var indent = flatXMLIndent(cx.state), xmlContext = cx.state.context\n        if (xmlContext && stream.match(/^[^>]*>\\s*$/, false)) {\n          while (xmlContext.prev && !xmlContext.startOfLine)\n            xmlContext = xmlContext.prev\n          if (xmlContext.startOfLine) indent -= config.indentUnit\n          else if (cx.prev.state.lexical) indent = cx.prev.state.lexical.indented\n        } else if (cx.depth == 1) {\n          indent += config.indentUnit\n        }\n\n        state.context = new Context(CodeMirror.startState(jsMode, indent),\n          jsMode, 0, state.context)\n        return null\n      }\n\n      if (cx.depth == 1) { \n        if (stream.peek() == \"<\") { \n          xmlMode.skipAttribute(cx.state)\n          state.context = new Context(CodeMirror.startState(xmlMode, flatXMLIndent(cx.state)),\n            xmlMode, 0, state.context)\n          return null\n        } else if (stream.match(\"//\")) {\n          stream.skipToEnd()\n          return \"comment\"\n        } else if (stream.match(\"/*\")) {\n          cx.depth = 2\n          return token(stream, state)\n        }\n      }\n\n      var style = xmlMode.token(stream, cx.state), cur = stream.current(), stop\n      if (/\\btag\\b/.test(style)) {\n        if (/>$/.test(cur)) {\n          if (cx.state.context) cx.depth = 0\n          else state.context = state.context.prev\n        } else if (/^</.test(cur)) {\n          cx.depth = 1\n        }\n      } else if (!style && (stop = cur.indexOf(\"{\")) > -1) {\n        stream.backUp(cur.length - stop)\n      }\n      return style\n    }\n\n    function jsToken(stream, state, cx) {\n      if (stream.peek() == \"<\" && jsMode.expressionAllowed(stream, cx.state)) {\n        jsMode.skipExpression(cx.state)\n        state.context = new Context(CodeMirror.startState(xmlMode, jsMode.indent(cx.state, \"\", \"\")),\n          xmlMode, 0, state.context)\n        return null\n      }\n\n      var style = jsMode.token(stream, cx.state)\n      if (!style && cx.depth != null) {\n        var cur = stream.current()\n        if (cur == \"{\") {\n          cx.depth++\n        } else if (cur == \"}\") {\n          if (--cx.depth == 0) state.context = state.context.prev\n        }\n      }\n      return style\n    }\n\n    return {\n      startState: function() {\n        return {context: new Context(CodeMirror.startState(jsMode), jsMode)}\n      },\n\n      copyState: function(state) {\n        return {context: copyContext(state.context)}\n      },\n\n      token: token,\n\n      indent: function(state, textAfter, fullLine) {\n        return state.context.mode.indent(state.context.state, textAfter, fullLine)\n      },\n\n      innerMode: function(state) {\n        return state.context\n      }\n    }\n  }, \"xml\", \"javascript\")\n\n  CodeMirror.defineMIME(\"text/jsx\", \"jsx\")\n  CodeMirror.defineMIME(\"text/typescript-jsx\", {name: \"jsx\", base: {name: \"javascript\", typescript: true}})\n}"],"names":[],"mappings":"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"}