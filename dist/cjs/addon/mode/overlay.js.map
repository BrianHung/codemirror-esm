{"version":3,"file":"overlay.js","sources":["../../../../src/addon/mode/overlay.js"],"sourcesContent":["// Source: https://github.com/codemirror/CodeMirror/tree/master/addon/mode/overlay.js\nexport default function(CodeMirror) {\n  \"use strict\";\n\n  CodeMirror.overlayMode = function(base, overlay, combine) {\n    return {\n      startState: function() {\n        return {\n          base: CodeMirror.startState(base),\n          overlay: CodeMirror.startState(overlay),\n          basePos: 0, baseCur: null,\n          overlayPos: 0, overlayCur: null,\n          streamSeen: null\n        };\n      },\n      copyState: function(state) {\n        return {\n          base: CodeMirror.copyState(base, state.base),\n          overlay: CodeMirror.copyState(overlay, state.overlay),\n          basePos: state.basePos, baseCur: null,\n          overlayPos: state.overlayPos, overlayCur: null\n        };\n      },\n\n      token: function(stream, state) {\n        if (stream != state.streamSeen ||\n          Math.min(state.basePos, state.overlayPos) < stream.start) {\n          state.streamSeen = stream;\n          state.basePos = state.overlayPos = stream.start;\n        }\n\n        if (stream.start == state.basePos) {\n          state.baseCur = base.token(stream, state.base);\n          state.basePos = stream.pos;\n        }\n        if (stream.start == state.overlayPos) {\n          stream.pos = stream.start;\n          state.overlayCur = overlay.token(stream, state.overlay);\n          state.overlayPos = stream.pos;\n        }\n        stream.pos = Math.min(state.basePos, state.overlayPos);\n\n        if (state.overlayCur == null) return state.baseCur;\n        else if (state.baseCur != null &&\n               state.overlay.combineTokens ||\n               combine && state.overlay.combineTokens == null)\n          return state.baseCur + \" \" + state.overlayCur;\n        else return state.overlayCur;\n      },\n\n      indent: base.indent && function(state, textAfter, line) {\n        return base.indent(state.base, textAfter, line);\n      },\n      electricChars: base.electricChars,\n\n      innerMode: function(state) { return {state: state.base, mode: base}; },\n\n      blankLine: function(state) {\n        var baseToken, overlayToken;\n        if (base.blankLine) baseToken = base.blankLine(state.base);\n        if (overlay.blankLine) overlayToken = overlay.blankLine(state.overlay);\n\n        return overlayToken == null ?\n          baseToken :\n          (combine && baseToken != null ? baseToken + \" \" + overlayToken : overlayToken);\n      }\n    };\n  };\n\n}"],"names":[],"mappings":";;AAAA;AACe,iBAAS,UAAU,EAAE;AAEpC;AACA,EAAE,UAAU,CAAC,WAAW,GAAG,SAAS,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE;AAC5D,IAAI,OAAO;AACX,MAAM,UAAU,EAAE,WAAW;AAC7B,QAAQ,OAAO;AACf,UAAU,IAAI,EAAE,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC;AAC3C,UAAU,OAAO,EAAE,UAAU,CAAC,UAAU,CAAC,OAAO,CAAC;AACjD,UAAU,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,IAAI;AACnC,UAAU,UAAU,EAAE,CAAC,EAAE,UAAU,EAAE,IAAI;AACzC,UAAU,UAAU,EAAE,IAAI;AAC1B,SAAS,CAAC;AACV,OAAO;AACP,MAAM,SAAS,EAAE,SAAS,KAAK,EAAE;AACjC,QAAQ,OAAO;AACf,UAAU,IAAI,EAAE,UAAU,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC;AACtD,UAAU,OAAO,EAAE,UAAU,CAAC,SAAS,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC;AAC/D,UAAU,OAAO,EAAE,KAAK,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI;AAC/C,UAAU,UAAU,EAAE,KAAK,CAAC,UAAU,EAAE,UAAU,EAAE,IAAI;AACxD,SAAS,CAAC;AACV,OAAO;AACP;AACA,MAAM,KAAK,EAAE,SAAS,MAAM,EAAE,KAAK,EAAE;AACrC,QAAQ,IAAI,MAAM,IAAI,KAAK,CAAC,UAAU;AACtC,UAAU,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,UAAU,CAAC,GAAG,MAAM,CAAC,KAAK,EAAE;AACpE,UAAU,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC;AACpC,UAAU,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC,KAAK,CAAC;AAC1D,SAAS;AACT;AACA,QAAQ,IAAI,MAAM,CAAC,KAAK,IAAI,KAAK,CAAC,OAAO,EAAE;AAC3C,UAAU,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;AACzD,UAAU,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC,GAAG,CAAC;AACrC,SAAS;AACT,QAAQ,IAAI,MAAM,CAAC,KAAK,IAAI,KAAK,CAAC,UAAU,EAAE;AAC9C,UAAU,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC;AACpC,UAAU,KAAK,CAAC,UAAU,GAAG,OAAO,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;AAClE,UAAU,KAAK,CAAC,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC;AACxC,SAAS;AACT,QAAQ,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,UAAU,CAAC,CAAC;AAC/D;AACA,QAAQ,IAAI,KAAK,CAAC,UAAU,IAAI,IAAI,IAAE,OAAO,KAAK,CAAC,OAAO,GAAC;AAC3D,aAAa,IAAI,KAAK,CAAC,OAAO,IAAI,IAAI;AACtC,eAAe,KAAK,CAAC,OAAO,CAAC,aAAa;AAC1C,eAAe,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,aAAa,IAAI,IAAI;AAC7D,YAAU,OAAO,KAAK,CAAC,OAAO,GAAG,GAAG,GAAG,KAAK,CAAC,UAAU,GAAC;AACxD,eAAa,OAAO,KAAK,CAAC,UAAU,GAAC;AACrC,OAAO;AACP;AACA,MAAM,MAAM,EAAE,IAAI,CAAC,MAAM,IAAI,SAAS,KAAK,EAAE,SAAS,EAAE,IAAI,EAAE;AAC9D,QAAQ,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;AACxD,OAAO;AACP,MAAM,aAAa,EAAE,IAAI,CAAC,aAAa;AACvC;AACA,MAAM,SAAS,EAAE,SAAS,KAAK,EAAE,EAAE,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,EAAE;AAC5E;AACA,MAAM,SAAS,EAAE,SAAS,KAAK,EAAE;AACjC,QAAQ,IAAI,SAAS,EAAE,YAAY,CAAC;AACpC,QAAQ,IAAI,IAAI,CAAC,SAAS,IAAE,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,GAAC;AACnE,QAAQ,IAAI,OAAO,CAAC,SAAS,IAAE,YAAY,GAAG,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,GAAC;AAC/E;AACA,QAAQ,OAAO,YAAY,IAAI,IAAI;AACnC,UAAU,SAAS;AACnB,WAAW,OAAO,IAAI,SAAS,IAAI,IAAI,GAAG,SAAS,GAAG,GAAG,GAAG,YAAY,GAAG,YAAY,CAAC,CAAC;AACzF,OAAO;AACP,KAAK,CAAC;AACN,GAAG,CAAC;AACJ;AACA;;;;"}