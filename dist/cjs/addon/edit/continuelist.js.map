{"version":3,"file":"continuelist.js","sources":["../../../../src/addon/edit/continuelist.js"],"sourcesContent":["// Source: https://github.com/codemirror/CodeMirror/tree/master/addon/edit/continuelist.js\nexport default function(CodeMirror) {\n  \"use strict\";\n\n  var listRE = /^(\\s*)(>[> ]*|[*+-] \\[[x ]\\]\\s|[*+-]\\s|(\\d+)([.)]))(\\s*)/,\n    emptyListRE = /^(\\s*)(>[> ]*|[*+-] \\[[x ]\\]|[*+-]|(\\d+)[.)])(\\s*)$/,\n    unorderedListRE = /[*+-]\\s/;\n\n  CodeMirror.commands.newlineAndIndentContinueMarkdownList = function(cm) {\n    if (cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n    var ranges = cm.listSelections(), replacements = [];\n    for (var i = 0; i < ranges.length; i++) {\n      var pos = ranges[i].head;\n\n      var eolState = cm.getStateAfter(pos.line);\n      var inner = CodeMirror.innerMode(cm.getMode(), eolState);\n      if (inner.mode.name !== \"markdown\") {\n        cm.execCommand(\"newlineAndIndent\");\n        return;\n      } else {\n        eolState = inner.state;\n      }\n\n      var inList = eolState.list !== false;\n      var inQuote = eolState.quote !== 0;\n\n      var line = cm.getLine(pos.line), match = listRE.exec(line);\n      var cursorBeforeBullet = /^\\s*$/.test(line.slice(0, pos.ch));\n      if (!ranges[i].empty() || (!inList && !inQuote) || !match || cursorBeforeBullet) {\n        cm.execCommand(\"newlineAndIndent\");\n        return;\n      }\n      if (emptyListRE.test(line)) {\n        var endOfQuote = inQuote && />\\s*$/.test(line)\n        var endOfList = !/>\\s*$/.test(line)\n        if (endOfQuote || endOfList) cm.replaceRange(\"\", {\n          line: pos.line, ch: 0\n        }, {\n          line: pos.line, ch: pos.ch + 1\n        });\n        replacements[i] = \"\\n\";\n      } else {\n        var indent = match[1], after = match[5];\n        var numbered = !(unorderedListRE.test(match[2]) || match[2].indexOf(\">\") >= 0);\n        var bullet = numbered ? (parseInt(match[3], 10) + 1) + match[4] : match[2].replace(\"x\", \" \");\n        replacements[i] = \"\\n\" + indent + bullet + after;\n\n        if (numbered) incrementRemainingMarkdownListNumbers(cm, pos);\n      }\n    }\n\n    cm.replaceSelections(replacements);\n  };\n\n  function incrementRemainingMarkdownListNumbers(cm, pos) {\n    var startLine = pos.line, lookAhead = 0, skipCount = 0;\n    var startItem = listRE.exec(cm.getLine(startLine)), startIndent = startItem[1];\n\n    do {\n      lookAhead += 1;\n      var nextLineNumber = startLine + lookAhead;\n      var nextLine = cm.getLine(nextLineNumber), nextItem = listRE.exec(nextLine);\n\n      if (nextItem) {\n        var nextIndent = nextItem[1];\n        var newNumber = (parseInt(startItem[3], 10) + lookAhead - skipCount);\n        var nextNumber = (parseInt(nextItem[3], 10)), itemNumber = nextNumber;\n\n        if (startIndent === nextIndent && !isNaN(nextNumber)) {\n          if (newNumber === nextNumber) itemNumber = nextNumber + 1;\n          if (newNumber > nextNumber) itemNumber = newNumber + 1;\n          cm.replaceRange(\n            nextLine.replace(listRE, nextIndent + itemNumber + nextItem[4] + nextItem[5]),\n            {\n              line: nextLineNumber, ch: 0\n            }, {\n              line: nextLineNumber, ch: nextLine.length\n            });\n        } else {\n          if (startIndent.length > nextIndent.length) return;\n          if ((startIndent.length < nextIndent.length) && (lookAhead === 1)) return;\n          skipCount += 1;\n        }\n      }\n    } while (nextItem);\n  }\n}"],"names":[],"mappings":";;AAAA;AACe,sBAAS,UAAU,EAAE;AAEpC;AACA,EAAE,IAAI,MAAM,GAAG,0DAA0D;AACzE,IAAI,WAAW,GAAG,qDAAqD;AACvE,IAAI,eAAe,GAAG,SAAS,CAAC;AAChC;AACA,EAAE,UAAU,CAAC,QAAQ,CAAC,oCAAoC,GAAG,SAAS,EAAE,EAAE;AAC1E,IAAI,IAAI,EAAE,CAAC,SAAS,CAAC,cAAc,CAAC,IAAE,OAAO,UAAU,CAAC,IAAI,GAAC;AAC7D,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC,cAAc,EAAE,EAAE,YAAY,GAAG,EAAE,CAAC;AACxD,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC5C,MAAM,IAAI,GAAG,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;AAC/B;AACA,MAAM,IAAI,QAAQ,GAAG,EAAE,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAChD,MAAM,IAAI,KAAK,GAAG,UAAU,CAAC,SAAS,CAAC,EAAE,CAAC,OAAO,EAAE,EAAE,QAAQ,CAAC,CAAC;AAC/D,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,UAAU,EAAE;AAC1C,QAAQ,EAAE,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC;AAC3C,QAAQ,OAAO;AACf,OAAO,MAAM;AACb,QAAQ,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC;AAC/B,OAAO;AACP;AACA,MAAM,IAAI,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,KAAK,CAAC;AAC3C,MAAM,IAAI,OAAO,GAAG,QAAQ,CAAC,KAAK,KAAK,CAAC,CAAC;AACzC;AACA,MAAM,IAAI,IAAI,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACjE,MAAM,IAAI,kBAAkB,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;AACnE,MAAM,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,IAAI,kBAAkB,EAAE;AACvF,QAAQ,EAAE,CAAC,WAAW,CAAC,kBAAkB,CAAC,CAAC;AAC3C,QAAQ,OAAO;AACf,OAAO;AACP,MAAM,IAAI,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;AAClC,QAAQ,IAAI,UAAU,GAAG,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI,EAAC;AACtD,QAAQ,IAAI,SAAS,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAC;AAC3C,QAAQ,IAAI,UAAU,IAAI,SAAS,IAAE,EAAE,CAAC,YAAY,CAAC,EAAE,EAAE;AACzD,UAAU,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,EAAE,EAAE,CAAC;AAC/B,SAAS,EAAE;AACX,UAAU,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,GAAG,CAAC;AACxC,SAAS,CAAC,GAAC;AACX,QAAQ,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;AAC/B,OAAO,MAAM;AACb,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;AAChD,QAAQ,IAAI,QAAQ,GAAG,EAAE,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;AACvF,QAAQ,IAAI,MAAM,GAAG,QAAQ,GAAG,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AACrG,QAAQ,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,GAAG,MAAM,GAAG,MAAM,GAAG,KAAK,CAAC;AACzD;AACA,QAAQ,IAAI,QAAQ,IAAE,qCAAqC,CAAC,EAAE,EAAE,GAAG,CAAC,GAAC;AACrE,OAAO;AACP,KAAK;AACL;AACA,IAAI,EAAE,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;AACvC,GAAG,CAAC;AACJ;AACA,EAAE,SAAS,qCAAqC,CAAC,EAAE,EAAE,GAAG,EAAE;AAC1D,IAAI,IAAI,SAAS,GAAG,GAAG,CAAC,IAAI,EAAE,SAAS,GAAG,CAAC,EAAE,SAAS,GAAG,CAAC,CAAC;AAC3D,IAAI,IAAI,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,WAAW,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;AACnF;AACA,IAAI,GAAG;AACP,MAAM,SAAS,IAAI,CAAC,CAAC;AACrB,MAAM,IAAI,cAAc,GAAG,SAAS,GAAG,SAAS,CAAC;AACjD,MAAM,IAAI,QAAQ,GAAG,EAAE,CAAC,OAAO,CAAC,cAAc,CAAC,EAAE,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;AAClF;AACA,MAAM,IAAI,QAAQ,EAAE;AACpB,QAAQ,IAAI,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;AACrC,QAAQ,IAAI,SAAS,IAAI,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,SAAS,GAAG,SAAS,CAAC,CAAC;AAC7E,QAAQ,IAAI,UAAU,IAAI,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,UAAU,GAAG,UAAU,CAAC;AAC9E;AACA,QAAQ,IAAI,WAAW,KAAK,UAAU,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE;AAC9D,UAAU,IAAI,SAAS,KAAK,UAAU,IAAE,UAAU,GAAG,UAAU,GAAG,CAAC,GAAC;AACpE,UAAU,IAAI,SAAS,GAAG,UAAU,IAAE,UAAU,GAAG,SAAS,GAAG,CAAC,GAAC;AACjE,UAAU,EAAE,CAAC,YAAY;AACzB,YAAY,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,UAAU,GAAG,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;AACzF,YAAY;AACZ,cAAc,IAAI,EAAE,cAAc,EAAE,EAAE,EAAE,CAAC;AACzC,aAAa,EAAE;AACf,cAAc,IAAI,EAAE,cAAc,EAAE,EAAE,EAAE,QAAQ,CAAC,MAAM;AACvD,aAAa,CAAC,CAAC;AACf,SAAS,MAAM;AACf,UAAU,IAAI,WAAW,CAAC,MAAM,GAAG,UAAU,CAAC,MAAM,IAAE,SAAO;AAC7D,UAAU,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,UAAU,CAAC,MAAM,MAAM,SAAS,KAAK,CAAC,CAAC,IAAE,SAAO;AACpF,UAAU,SAAS,IAAI,CAAC,CAAC;AACzB,SAAS;AACT,OAAO;AACP,KAAK,QAAQ,QAAQ,EAAE;AACvB,GAAG;AACH;;;;"}